<div class="row">
  <div class="col-sm-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">Add New Inventory</h4>
      </div>
      <div class="panel-body">
        <form ng-submit="save()">
          <div class="row">
            <div class="col-sm-12">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">Order Detail</h4>
                </div>
                <div class="panel-body">
                  <div class="row">
                    <div class="col-sm-12">
                      <div class="col-sm-6">
                        <div class="form-group">
                          <label for="sendingFacility" translate="sendingFacility"></label>
                          <select id="sendingFacility" class="form-control" ng-model="inventory.sending_facility"
                                  required>
                            <option value="" translate="selectSendingFacility"></option>
                            <option ng-repeat="facility in facilities" value="{{ facility.uuid }}"
                                    ng-bind="facility.name"></option>
                          </select>
                        </div>
                      </div>

                      <div class="col-sm-6">
                        <div class="form-group">
                          <label for="receivingFacility" translate="receivingFacility"></label>
                          <select id="receivingFacility" class="form-control" ng-model="inventory.receiving_facility"
                                  ng-change="loadReceivingFacilityStorageUnits(inventory.receiving_facility)" required>
                            <option value="" translate="selectReceivingFacility"></option>
                            <option ng-repeat="facility in facilities" value="{{ facility.uuid }}"
                                    ng-bind="facility.name"></option>
                          </select>
                        </div>
                      </div>

                      <div class="col-sm-6">
                        <div class="form-group">
                          <label for="bundleNo" translate="bundleNo"></label>
                          <input class="form-control" type="text" name="bundleNo" id="bundleNo"
                                 ng-model="inventory.bundle_no" placeholder="e.g KNC-THF-01-9803"/>
                        </div>
                      </div>

                      <div class="col-sm-6">
                        <div class="form-group">
                          <label for="receiptDate" translate="dateReceived"> <i
                                  class="fa fa-calendar"></i></label>
                          <input ng-model="inventory.date_receipt" class="form-control" type="date" name="receiptDate"
                                 id="receiptDate" required=""/>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">New Inventory Detail</h4>
                </div>

                <div class="panel-body" ng-show="(inventory.inventoryLines).length !== 0">
                  <div class="row">
                    <div class="col-sm-12">
                      <div class="col-sm-12">

                        <table class="table table-condensed table-hover table-bordered">
                          <tr>
                            <thead>
                            <th>#</th>
                            <th class="text-titlecase" translate="productTypes"></th>
                            <th class="text-titlecase" translate="batchNo"></th>
                            <th class="text-titlecase" translate="program"></th>
                            <th class="text-titlecase" translate="quantity"></th>
                            <th class="text-titlecase" translate="uom"></th>
                            <th class="text-titlecase" translate="storageUnit"></th>
                            <th class="text-titlecase" translate="remove"></th>
                            </thead>
                          </tr>
                          <tr ng-repeat="inventoryLine in inventory.inventoryLines">
                            <td ng-bind="($index + 1)"></td>
                            <td>
                              <select ng-model="inventoryLine.productType" class="form-control"
                                      ng-change="loadProductTypeBatches(inventoryLine)">
                                <option value="" translate="selectProductType"></option>
                                <option ng-repeat="type in inventoryLine.productTypes" value="{{ type.uuid }}"
                                        ng-selected="{{ (inventoryLine.productType).uuid === type.uuid}}"
                                        ng-bind="type.name">
                                </option>
                              </select>
                            </td>
                            <td>
                              <select ng-model="inventoryLine.selectedBatch" class="form-control"
                                      ng-change="updateBatchNo(inventoryLine)"
                                      ng-disabled="inventoryLine.isDisabled">
                                <option value="" translate="selectBatch"></option>
                                <option ng-repeat="batch in inventoryLine.productTypeBatches" value="{{ batch.uuid }}"
                                        ng-bind="batch.batch_no">
                                </option>
                              </select>
                              <br/>
                              <input class="form-control" type="text" name="batchNo" ng-model="inventoryLine.batch_no"/>
                            </td>
                            <td>
                              <select ng-model="inventoryLine.program" class="form-control">
                                <option value="" translate="selectProgram"></option>
                                <option ng-repeat="program in programs" value="{{ program.uuid }}"
                                        ng-selected="{{ (inventoryLine.program).uuid === program.uuid}}"
                                        ng-bind="program.name"></option>
                              </select>
                            </td>
                            <td>
                              <input class="form-control" type="number" min="0" step="any" name="quantity"
                                     ng-model="inventoryLine.quantity"/>
                            </td>
                            <td>
                              <select class="form-control" ng-model="inventoryLine.uom">
                                <option value="" translate="selectUOM"></option>
                                <option ng-repeat="uom in uomList" value="{{ uom.uuid }}" ng-bind="uom.name"
                                        ng-selected="{{ (inventoryLine.uom).uuid === uom.uuid }}"></option>
                              </select>
                            </td>
                            <td>
                              <select class="form-control" ng-model="inventoryLine.storage_unit">
                                <option value="" translate="addToStorageUnit"></option>
                                <option ng-repeat="storageUnit in receivingFacilityStorageUnits"
                                        value="{{ storageUnit.uuid }}"
                                        ng-selected="{{ (inventoryLine.storageUnit).uuid === storageUnit.uuid }}"
                                        ng-bind="storageUnit.name ">
                                </option>
                              </select>
                            </td>
                            <td>
                              <i ng-click="removeInventoryLine(inventoryLine)"
                                 class="pull-center text-muted fa fa-times fa-2x"></i>
                            </td>
                          </tr>
                        </table>

                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="form-group">
              <div class="col-md-4 pull-left">
                <button type="button" name="addInventoryLine" class="btn btn-default" ng-click="addInventoryLine()">
                  <span><i class="fa fa-plus"></i></span>
                  <span>Add inventory line</span>
                </button>
              </div>

              <div class="col-md-4 pull-right">
                <button type="button" id="authorize" name="authorize" class="btn btn-default"
                        ng-disabled="inventory.authorized"
                        translate="authorize" ng-click="inventory.authorized =true"></button>
                <button id="submit" name="submit" class="btn btn-success"
                        translate="submit" ng-disabled="!inventory.authorized"></button>
              </div>
            </div>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>
